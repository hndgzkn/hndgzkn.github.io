
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Model descriptions &#8212; alphacsc 0.4rc11 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-rendered-html.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples Gallery" href="auto_examples/index.html" />
    <link rel="prev" title="alphaCSC: Convolution sparse coding for time-series" href="index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="index.html">
<p class="title">alphacsc</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="current reference internal nav-link" href="#">
  Model descriptions
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="auto_examples/index.html">
  Examples Gallery
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="api.html">
  API Documentation
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-primary btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        0.4rc11  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>

<!-- NOTE: this JS must live here (not in our global JS file) because it relies
     on being processed by Jinja before it is run (specifically for replacing
     variables models and {'json_url': '/dev/_static/switcher.json', 'version_match': '0.4rc11'}.
-->

<script type="text/javascript">
// Check if corresponding page path exists in other version of docs
// and, if so, go there instead of the homepage of the other docs version
function checkPageExistsAndRedirect(event) {
    const currentFilePath = "models.html",
          tryUrl = event.target.getAttribute("href");
    let otherDocsHomepage = tryUrl.replace(currentFilePath, "");
    $.ajax({
        type: 'HEAD',
        url: tryUrl,
        // if the page exists, go there
        success: function() {
            location.href = tryUrl;
        }
    }).fail(function() {
        location.href = otherDocsHomepage;
    });
    // this prevents the browser from following the href of the clicked node
    // (which is fine because this function takes care of redirecting)
    return false;
}

// Populate the version switcher from the JSON config file
(function () {
    $.getJSON("/dev/_static/switcher.json", function(data, textStatus, jqXHR) {
        const currentFilePath = "models.html";
        // create links to the corresponding page in the other docs versions
        $.each(data, function(index, entry) {
            // if no custom name specified (e.g., "latest"), use version string
            if (!("name" in entry)) {
                entry.name = entry.version;
            }
            // create the node
            const node = document.createElement("a");
            node.setAttribute("class", "list-group-item list-group-item-action py-1");
            node.textContent = `${entry.name}`;
            node.setAttribute("href", `${entry.url}${currentFilePath}`);
            // on click, AJAX calls will check if the linked page exists before
            // trying to redirect, and if not, will redirect to the homepage
            // for that version of the docs.
            node.onclick = checkPageExistsAndRedirect;
            // Add dataset values for the version and name in case people want
            // to apply CSS styling based on this information.
            node.dataset["versionName"] = entry.name;
            node.dataset["version"] = entry.version;

            $("#version_switcher_menu").append(node);
            // replace dropdown button text with the preferred display name of
            // this version, rather than using sphinx's 0.4rc11 variable.
            // also highlight the dropdown entry for the currently-viewed
            // version's entry
            if (entry.version == "0.4rc11") {
                node.classList.add("active");
                let btn = document.getElementById("version_switcher_button");
                btn.innerText = btn.dataset["activeVersionName"] = entry.name;
                btn.dataset["activeVersion"] = entry.version;
            }
        });
    });
})();
</script>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/alphacsc/alphacsc" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://pypi.org/project/alphacsc/" rel="noopener" target="_blank" title="PyPI"><span><i class="fas fa-box"></i></span>
            <label class="sr-only">PyPI</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#univariate-csc">
   1. Univariate CSC
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multivariate-csc">
   2. Multivariate CSC
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multivariate-csc-with-a-rank-1-constraint">
   3. Multivariate CSC with a rank-1 constraint
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#univariate-csc-with-an-alpha-stable-distribution">
   4. Univariate CSC with an alpha-stable distribution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cite-our-work">
   Cite our work
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="model-descriptions">
<h1>Model descriptions<a class="headerlink" href="#model-descriptions" title="Permalink to this headline">#</a></h1>
<p>AlphaCSC is a library to perform shift-invariant <a class="reference external" href="https://en.wikipedia.org/wiki/Sparse_dictionary_learning">sparse dictionary learning</a>, also known as
convolutional sparse coding (CSC), on time-series data.
It includes a number of different models:</p>
<ol class="arabic simple">
<li><p>univariate CSC</p></li>
<li><p>multivariate CSC</p></li>
<li><p>multivariate CSC with a rank-1 constraint <a class="footnote-reference brackets" href="#id5" id="id1">1</a></p></li>
<li><p>univariate CSC with an alpha-stable distribution <a class="footnote-reference brackets" href="#id6" id="id2">2</a></p></li>
</ol>
<div class="section" id="univariate-csc">
<h2>1. Univariate CSC<a class="headerlink" href="#univariate-csc" title="Permalink to this headline">#</a></h2>
<p>Framed mathematically, if we are giving a signal <span class="math notranslate nohighlight">\(x^n \in \mathbb{R}^T\)</span>,
we want to learn <span class="math notranslate nohighlight">\(k\)</span> atoms <span class="math notranslate nohighlight">\(d^k \in \mathbb{R}^{L}\)</span> and their
associated activations <span class="math notranslate nohighlight">\(z_k^n \in \mathbb{R}^{T - L + 1}\)</span>. The
optimization problem boils down to minimizing an <span class="math notranslate nohighlight">\(\ell_2\)</span> reconstruction
loss, which corresponds to a Gaussian noise model, with a sparsity-inducing
<span class="math notranslate nohighlight">\(\ell_1\)</span> penalty term:</p>
<div class="math notranslate nohighlight">
\[\min_{d,z} \sum_n \left(\|x^n - \sum_k d^k * z_k^n \|_2^2 + \lambda \sum_k z_k^n \right)\]</div>
<p>subject to <span class="math notranslate nohighlight">\(z_k^n \ge 0\)</span> and <span class="math notranslate nohighlight">\(||d_k||_2 \le 1\)</span>. The shift invariance
is encoded by the convolution operator <span class="math notranslate nohighlight">\(*\)</span> which is why these methods are
called <strong>convolutional</strong> sparse coding.</p>
</div>
<div class="section" id="multivariate-csc">
<h2>2. Multivariate CSC<a class="headerlink" href="#multivariate-csc" title="Permalink to this headline">#</a></h2>
<p>In the multivariate case, we are giving a multivariate signal <span class="math notranslate nohighlight">\(X^n \in
\mathbb{R}^{T \times P}\)</span>, where <span class="math notranslate nohighlight">\(P\)</span> is the dimension of the signal, and
we want to learn <span class="math notranslate nohighlight">\(k\)</span> multivariate atoms <span class="math notranslate nohighlight">\(D_k \in \mathbb{R}^{L
\times P}\)</span> and their associated activations <span class="math notranslate nohighlight">\(z_k^n \in \mathbb{R}^{T - L +
1}\)</span>. The objective function reads:</p>
<div class="math notranslate nohighlight">
\[\min_{D,z} \sum_n \left(\|X^n - \sum_k D_k * z_k^n \|_2^2 + \lambda \sum_k z_k^n \right)\]</div>
<p>subject to <span class="math notranslate nohighlight">\(z_k^n \ge 0\)</span> and <span class="math notranslate nohighlight">\(||D_k||_2 \le 1\)</span>.</p>
</div>
<div class="section" id="multivariate-csc-with-a-rank-1-constraint">
<h2>3. Multivariate CSC with a rank-1 constraint<a class="headerlink" href="#multivariate-csc-with-a-rank-1-constraint" title="Permalink to this headline">#</a></h2>
<p>A variant of the multivariate CSC model considers an additional constraint on
the multivariate atoms, stating that they need to be rank-1. In other words,
each atom can be written as a product of univariate vectors <span class="math notranslate nohighlight">\(D_k = u_k
v_k^\top\)</span>, where <span class="math notranslate nohighlight">\(u_k^\top \in \mathbb{R}^{P}\)</span> is the pattern over
channels, and <span class="math notranslate nohighlight">\(v_k^\top \in \mathbb{R}^{L}\)</span> is the pattern over time. The
objective function reads:</p>
<div class="math notranslate nohighlight">
\[\min_{u, v, z} \sum_n \left(\|X^n - \sum_k (u_k v_k^\top) * z_k^n \|_2^2 + \lambda \sum_k z_k^n \right)\]</div>
<p>subject to <span class="math notranslate nohighlight">\(z_k^n \ge 0\)</span>, <span class="math notranslate nohighlight">\(||u_k||_2 \le 1\)</span>, and <span class="math notranslate nohighlight">\(||v_k||_2
\le 1\)</span>. This rank-1 formulation is particularly meaningful in the case of
magnetoencephalography (MEG), due to the physical properties of electromagnetic
waves, which propagate instantaneously and add up linearly. It also brings
robustness to the atom estimates, since less parameters are estimated.</p>
<p>This model is described in details in the original NIPS paper <a class="footnote-reference brackets" href="#id5" id="id3">1</a>.</p>
</div>
<div class="section" id="univariate-csc-with-an-alpha-stable-distribution">
<h2>4. Univariate CSC with an alpha-stable distribution<a class="headerlink" href="#univariate-csc-with-an-alpha-stable-distribution" title="Permalink to this headline">#</a></h2>
<p>The name alphaCSC originally referred to a particular model which uses an
<a class="reference external" href="https://en.wikipedia.org/wiki/Stable_distribution">alpha-stable distribution</a>
for the noise, instead of the more classical Gaussian distribution. Note that
the <code class="docutils literal notranslate"><span class="pre">alphaCSC</span></code> library is <strong>not</strong> limited to this particular model.</p>
<p>This model leads to a weighted formulation of univariate CSC, the weights being
used to downweight noisy portions of the data:</p>
<div class="math notranslate nohighlight">
\[\min_{d,z} \sum_n \left( \|\sqrt{w_n} \odot (x^n - \sum_k d_k * z_k^n) \|_2^2 + \lambda \sum_k z_k^n \right)\]</div>
<p>subject to <span class="math notranslate nohighlight">\(z_k^n \ge 0\)</span> and <span class="math notranslate nohighlight">\(||d_k||_2 \le 1\)</span>, and  where
<span class="math notranslate nohighlight">\(w_n\)</span> are the weights which are learned using an <a class="reference external" href="https://en.wikipedia.org/wiki/Expectation%E2%80%93maximization_algorithm">EM algorithm</a>.</p>
<p>This model is described in details in the original NIPS paper <a class="footnote-reference brackets" href="#id6" id="id4">2</a>.</p>
</div>
<div class="section" id="cite-our-work">
<h2>Cite our work<a class="headerlink" href="#cite-our-work" title="Permalink to this headline">#</a></h2>
<p>If you use this code in your project, please consider citing our work:</p>
<dl class="footnote brackets">
<dt class="label" id="id5"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id3">2</a>)</span></dt>
<dd><p>Dupré La Tour, T., Moreau, T., Jas, M., &amp; Gramfort, A. (2018).
<a class="reference external" href="https://arxiv.org/abs/1805.09654v2">Multivariate Convolutional Sparse Coding for Electromagnetic Brain Signals</a>. Advances in Neural Information
Processing Systems (NIPS).</p>
</dd>
<dt class="label" id="id6"><span class="brackets">2</span><span class="fn-backref">(<a href="#id2">1</a>,<a href="#id4">2</a>)</span></dt>
<dd><p>Jas, M., Dupré La Tour, T., Şimşekli, U., &amp; Gramfort, A. (2017). <a class="reference external" href="https://papers.nips.cc/paper/6710-learning-the-morphology-of-brain-signals-using-alpha-stable-convolutional-sparse-coding.pdf">Learning
the Morphology of Brain Signals Using Alpha-Stable Convolutional Sparse Coding</a>.
Advances in Neural Information Processing Systems (NIPS), pages 1099–1108.</p>
</dd>
</dl>
</div>
</div>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="index.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">alphaCSC: Convolution sparse coding for time-series</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="auto_examples/index.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Examples Gallery</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
    <script src="/versionwarning.js"></script>
    
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2017-2018, Mainak Jas.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>